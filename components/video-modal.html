<!-- components/video-modal.html -->
<div
  id="playerModal"
  class="bv-modal hidden"
  role="dialog"
  aria-modal="true"
  aria-labelledby="videoTitle"
>
  <div class="bv-modal-backdrop" data-dismiss></div>
  <div
    class="bv-modal__panel card player-modal__content flex max-h-[calc(100vh-2rem)] w-full flex-col overflow-hidden p-0 sm:max-h-[calc(100vh-3rem)]"
    tabindex="-1"
  >
    <div class="bv-modal__content flex h-full flex-col overflow-hidden">
      <header
        id="modalNav"
        class="modal-nav sticky top-0 z-[var(--z-modal-nav)] flex items-center justify-between gap-4 border-b border-border/60 bg-surface/95 px-6 py-4 backdrop-blur transition-transform duration-150"
      >
        <div class="flex items-center gap-3">
          <button
            id="closeModal"
            type="button"
            class="focus-ring inline-flex h-10 w-10 items-center justify-center rounded-full border border-border/50 bg-surface-alt/80 text-white shadow-md transition hover:bg-surface-alt"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-5 w-5"
            >
              <path d="M15 18l-6-6 6-6" />
            </svg>
            <span class="sr-only">Close player</span>
          </button>
        </div>
        <div class="modal-actions flex items-center gap-2">
          <button
            id="copyMagnetBtn"
            type="button"
            class="icon-button focus-ring inline-flex h-10 w-10 items-center justify-center rounded-full border border-border/50 bg-surface-alt/70 text-white transition hover:bg-surface-alt"
          >
            <img
              src="assets/svg/copy-magnet.svg"
              alt="Copy Magnet"
              class="h-5 w-5"
            />
          </button>
          <div class="relative" data-modal-zap-wrapper>
            <button
              id="modalZapBtn"
              type="button"
              class="icon-button focus-ring inline-flex h-10 w-10 items-center justify-center rounded-full border border-border/50 bg-surface-alt/70 text-white transition hover:bg-surface-alt"
              aria-label="Send a zap"
              aria-haspopup="dialog"
              aria-expanded="false"
              aria-controls="modalZapDialog"
            >
              <img
                src="assets/svg/lightning-bolt.svg"
                alt="Zap"
                class="h-5 w-5"
              />
            </button>
            <div
              id="modalZapDialog"
              class="zap-popover hidden"
              role="dialog"
              aria-hidden="true"
            >
              <div
                class="zap-popover__content card w-72 max-w-[calc(100vw-2rem)] space-y-3 rounded-lg p-4 shadow-lg"
              >
                <div class="flex items-center justify-between gap-4">
                  <h3
                    class="text-xs font-semibold uppercase tracking-wide text-gray-300"
                  >
                    Send a zap
                  </h3>
                  <button
                    type="button"
                    id="modalZapCloseBtn"
                    class="focus-ring inline-flex h-7 w-7 items-center justify-center rounded-full text-gray-300 transition hover:text-gray-100"
                    aria-label="Close zap dialog"
                  >
                    ✕
                  </button>
                </div>
                <p
                  id="modalZapWalletPrompt"
                  class="hidden text-sm text-gray-200"
                  aria-hidden="true"
                >
                  Connect a wallet in
                  <button
                    type="button"
                    id="modalZapWalletLink"
                    class="focus-ring font-semibold text-blue-300 underline decoration-dotted transition hover:text-blue-200"
                  >
                    Wallet Connect settings
                  </button>
                  to send zaps.
                </p>
                <form id="modalZapForm" class="space-y-3">
                  <div class="space-y-2">
                    <label
                      for="modalZapAmountInput"
                      class="text-xs font-semibold uppercase tracking-wide text-gray-300"
                    >
                      Zap amount (sats)
                    </label>
                    <input
                      id="modalZapAmountInput"
                      type="number"
                      min="1"
                      step="1"
                      inputmode="numeric"
                      class="focus-ring w-full rounded-md border border-border/60 bg-surface px-3 py-2 text-sm text-gray-100 shadow-sm placeholder:text-gray-500"
                      placeholder="Enter sats"
                    />
                  </div>
                  <div class="space-y-2">
                    <label
                      for="modalZapCommentInput"
                      class="text-xs font-semibold uppercase tracking-wide text-gray-300"
                    >
                      Comment (optional)
                    </label>
                    <textarea
                      id="modalZapCommentInput"
                      rows="2"
                      maxlength="280"
                      class="focus-ring w-full resize-y rounded-md border border-border/60 bg-surface px-3 py-2 text-sm text-gray-100 shadow-sm placeholder:text-gray-500"
                      placeholder="Include a note with your zap"
                    ></textarea>
                  </div>
                  <p
                    id="modalZapSplitSummary"
                    class="text-sm text-gray-300"
                    aria-live="polite"
                  >
                    Enter an amount to view the split.
                  </p>
                  <p
                    id="modalZapStatus"
                    class="text-xs text-gray-400"
                    role="status"
                    aria-live="polite"
                  ></p>
                  <ul
                    id="modalZapReceipts"
                    class="space-y-2 text-xs text-gray-300"
                  ></ul>
                  <div class="flex items-center justify-end gap-2">
                    <button
                      type="submit"
                      id="modalZapSendBtn"
                      class="btn px-4 py-2 text-xs"
                    >
                      Send
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <button
            id="shareBtn"
            type="button"
            class="icon-button focus-ring inline-flex h-10 w-10 items-center justify-center rounded-full border border-border/50 bg-surface-alt/70 text-white transition hover:bg-surface-alt"
          >
            <img
              src="assets/svg/share-video.svg"
              alt="Share Video"
              class="h-5 w-5"
            />
          </button>
          <div class="modal-actions__overflow" data-more-menu-wrapper="true">
            <button
              id="modalMoreBtn"
              type="button"
              class="icon-button focus-ring inline-flex h-10 w-10 items-center justify-center rounded-full border border-border/50 bg-surface-alt/70 text-white transition hover:bg-surface-alt"
              aria-haspopup="true"
              aria-expanded="false"
              aria-label="More"
              data-more-dropdown="modal"
            >
              <img src="assets/svg/ellipsis.svg" alt="More" class="h-5 w-5" />
            </button>
            <div
              id="moreDropdown-modal"
              class="absolute right-0 top-12 z-50 hidden w-48 rounded-lg border border-border/60 bg-surface-alt shadow-xl"
              role="menu"
              data-more-menu="true"
            >
              <div class="py-2">
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-gray-100 transition hover:bg-panel"
                  data-action="open-channel"
                  data-context="modal"
                >
                  Open channel
                </button>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-gray-100 transition hover:bg-panel"
                  data-action="copy-link"
                  data-context="modal"
                >
                  Copy link
                </button>
                <div
                  class="px-4 pt-2 pb-1 text-xs font-semibold uppercase tracking-wide text-gray-400"
                >
                  Boost on Nostr…
                </div>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-gray-100 transition hover:bg-panel"
                  data-action="repost-event"
                  data-context="modal"
                >
                  Repost (kind 6)
                </button>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-gray-100 transition hover:bg-panel"
                  data-action="mirror-video"
                  data-context="modal"
                >
                  Mirror (kind 1063)
                </button>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-gray-100 transition hover:bg-panel"
                  data-action="ensure-presence"
                  data-context="modal"
                >
                  Rebroadcast
                </button>
                <div class="my-2 border-t border-border/40"></div>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-red-400 transition hover:bg-critical hover:text-white"
                  data-action="blacklist-author"
                  data-context="modal"
                  data-blacklist-menu="true"
                >
                  Blacklist creator
                </button>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-red-400 transition hover:bg-critical hover:text-white"
                  data-action="block-author"
                  data-context="modal"
                >
                  Block creator
                </button>
                <button
                  class="focus-ring block w-full px-4 py-2 text-left text-sm text-gray-100 transition hover:bg-panel"
                  data-action="report"
                  data-context="modal"
                >
                  Report
                </button>
              </div>
            </div>
          </div>
        </div>
      </header>

      <div class="bv-modal__scroll flex-1 overflow-y-auto">
        <section
          class="bv-modal__video player-modal__video sticky top-0 z-[var(--z-modal-video)] border-b border-border/50 bg-surface px-6 pb-6 pt-6"
        >
          <div class="card flex items-center justify-center bg-black/70 p-0 shadow-xl">
            <video
              id="modalVideo"
              class="bv-modal__video-el focus-ring w-full rounded-xl border border-border/40 bg-black object-contain shadow-modal"
              controls
            ></video>
          </div>
        </section>

        <div class="bv-modal__info player-modal__info space-y-6 px-6 pb-8 pt-6">
          <div class="card space-y-4 bg-surface-alt/40 p-6">
            <h2 id="videoTitle" class="text-2xl font-semibold text-white"></h2>
            <div class="flex flex-col gap-3 text-sm text-gray-300 sm:flex-row sm:items-start sm:justify-between">
              <div class="modal-meta flex flex-wrap items-center gap-2 text-gray-400">
                <span id="videoTimestamp">Posted just now</span>
                <span id="videoEditedTimestamp" class="hidden">Last edited just now</span>
                <span id="videoViewCount" class="modal-view-count">– views</span>
              </div>
              <div id="modalStatus" class="text-gray-200">
                Initializing... Just give it a sec.
              </div>
            </div>
          </div>

          <div class="card flex items-center gap-4 bg-surface-alt/40 p-6">
            <div class="h-14 w-14 overflow-hidden rounded-full border border-border/50 bg-gray-800">
              <img
                id="creatorAvatar"
                src=""
                alt="Creator"
                class="h-full w-full object-cover"
              />
            </div>
            <div class="flex flex-col gap-1">
              <h3 id="creatorName" class="text-lg font-semibold text-white">
                Creator Name
              </h3>
              <p id="creatorNpub" class="text-sm text-gray-400">npub...</p>
            </div>
          </div>

          <div class="card bg-surface-alt/40 p-6">
            <p
              id="videoDescription"
              class="whitespace-pre-wrap text-gray-200"
            >
              No description available.
            </p>
          </div>

          <div class="card space-y-4 bg-surface-alt/40 p-6">
            <div class="h-2 w-full overflow-hidden rounded-full bg-gray-700">
              <div
                class="h-2 rounded-full bg-info"
                id="modalProgress"
                style="width: 0%"
              ></div>
            </div>
            <div class="flex flex-wrap items-center justify-between gap-3 text-sm text-gray-300">
              <span id="modalPeers">Peers: 0</span>
              <span id="modalSpeed">Speed: 0 KB/s</span>
              <span id="modalDownloaded">Downloaded: 0 MB / 0 MB</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
