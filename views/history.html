<!-- views/history.html -->
<section id="watchHistoryView" class="bv-stack" data-ds="new">
  <div class="bv-stack bv-stack--tight">
    <div
      class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between"
    >
      <div>
        <h2 class="text-xl font-semibold text-text">Watch History</h2>
        <p class="text-sm text-muted">
          Review the videos you recently played, grouped by day.
        </p>
      </div>
      <div class="flex flex-wrap gap-2" id="watchHistoryActions">
        <button
          type="button"
          data-history-action="clear-cache"
          class="btn-ghost"
        >
          Clear local cache
        </button>
        <button
          type="button"
          data-history-action="republish"
          class="btn"
        >
          Republish now
        </button>
      </div>
    </div>

    <div
      id="watchHistoryPrivacyBanner"
      class="card hidden p-md"
      role="status"
      aria-live="polite"
    >
      <div
        class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"
      >
        <p id="watchHistoryPrivacyMessage" class="text-sm text-info">
          Your history stays encrypted. Share metadata with relays to sync
          thumbnails across devices?
        </p>
        <div class="flex flex-wrap gap-2">
          <button id="watchHistoryPrivacyToggle" type="button" class="btn">
            Share metadata
          </button>
          <button
            id="watchHistoryPrivacyDismiss"
            type="button"
            class="btn-ghost"
          >
            Dismiss
          </button>
        </div>
      </div>
    </div>

    <div id="watchHistoryInfo" class="card p-md text-sm">
      Thumbnails and titles are hydrated locally from your device caches.
    </div>

    <div
      id="watchHistoryError"
      class="card hidden p-md text-sm text-critical"
      data-state="critical"
      role="alert"
    ></div>
  </div>

  <div id="watchHistoryLoading">
    <div id="watchHistoryStatus">
      <div class="sidebar-loading-wrapper" role="status" aria-live="polite">
        <div class="sidebar-loading-indicator">
          <span
            class="status-spinner status-spinner--inline"
            aria-hidden="true"
          ></span>
          <span class="sidebar-loading-text"
            >Fetching watch history from relaysâ€¦</span
          >
        </div>
      </div>
    </div>
  </div>

  <div
    id="watchHistoryGrid"
    class="grid-stack hidden"
    data-variant="cards"
    data-orientation="vertical"
  ></div>
  <p id="watchHistoryEmpty" class="hidden py-12 text-center text-muted">
    Your watch history is empty. Watch some videos to populate this list.
  </p>

  <button id="watchHistoryLoadMore" type="button" class="btn-ghost hidden w-full">
    Load more
  </button>

  <div id="watchHistorySentinel" class="hidden h-1 w-full"></div>

  <script type="module" src="js/historyView.js"></script>
</section>
